<!doctype html>
<html lang="en">
<head>
<meta charset="ISO-8859-1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script src="js/jquery-1.12.3.js" type="text/javascript"></script>
<script src="js/jquery.autocomplete.js" type="text/javascript"></script>

<link rel="stylesheet" href="css/bootstrap4.4.1.min.css" />
<link rel="stylesheet" href="css/formulaire.css" />

<title>Enquête LAM - volet médical</title>

<style type="text/css">
.titre {
	padding: 10px 0px;
}
</style>

</head>

<body>
	<form id="formMedical" class="container" method="post" action="save_medical.php">

		<div class="d-flex justify-content-center" style="margin-top: 30px">
			<div class="card">
				<div class="card-header">Enquête flash sur les situations de handicap-novembre 2019
					<div style="text-align: center;">Volet médical</div>
				</div>
			</div>
		</div>			

		<div class="card">
			<div class="card-header">Données médicales de la personne accueillie</div>
			<div class="card-body">
			
				<div class="row">
					<div class="col-md-2">
						<label for="poids" class="col-form-label">Poids (kg)</label>
						<input type="number" class="form-control" name="poids" id="poids" min="30" max="130" required="required" min="30" max="130"/>
					</div>
					<div class="col-md-2">
						<label for="taille" class="col-form-label">Taille (cm)</label>
						<input type="number" class="form-control" name="taille" id="taille" min="100" max="210" required="required" />
					</div>
				</div>

				<div class="row">

					<div class="col-md">
						<div class="titre">Motifs d'entrée au LAM</div>
	
						<div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="psy" id="psy">
								<label class="form-check-label" for="homme">Psychiatrique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="neuro" id="neuro">
								<label class="form-check-label" for="neuro">Neurologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="cardio">
								<label class="form-check-label" for="cardio">Cardiologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="diab">
								<label class="form-check-label" for="diab">Diabète</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="pneumo">
								<label class="form-check-label" for="pneumo">Pneumologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="nephro">
								<label class="form-check-label" for="nephro">Néphrologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="immuno">
								<label class="form-check-label" for="immuno">Immunodéficience</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="neo">
								<label class="form-check-label" for="neo">Néoplasique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="motifentree" value="autre" id="autre" onchange="selection_motif_entree()">
								<label class="form-check-label" for="autre">Autre</label>
							</div>
							<div class="form-check" id="autreentreeForm" style="display: none">
								<label for="autreentree">précisez </label>
								<input type="text" name="autreentree" id="autreentree" style="display: none" />
							</div>
						</div>
						<div style="margin-top: 30px">
							<label for="cim10" class="col-form-label titre">Pathologies présentes au moment de l'enquête</label>
							<input type="text" class="form-control" id="cim10" name="cim10" class="form-control"
								placeholder="Rechercher une maladie..."
								aria-describedby="inputSuccess2Status"
								name="cim10"/>
							
						</div>
					</div>

					<div class="col-md">
	
						<div class="titre">Pathologies présentes au moment de l'enquête</div>
	
						<div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="psy">
								<label class="form-check-label" for="psy">Psychiatrique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="neuro">
								<label class="form-check-label" for="autre">Neurologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="cardio">
								<label class="form-check-label" for="autre">Cardiovasculaire</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="diab">
								<label class="form-check-label" for="autre">Diabète</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="pneumo">
								<label class="form-check-label" for="autre">Pneumologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="nephro">
								<label class="form-check-label" for="autre">Néphrologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="pall">
								<label class="form-check-label" for="autre">Soins palliatifs</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="uro">
								<label class="form-check-label" for="autre">Urologique</label>
														</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="dermato">
								<label class="form-check-label" for="autre">Dermatologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="Hemato">
								<label class="form-check-label" for="autre">Hématologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="ophtalmo">
								<label class="form-check-label" for="autre">Ophtalmologique</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="orl">
								<label class="form-check-label" for="autre">ORL</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="immuno">
								<label class="form-check-label" for="autre">Immunodéficience</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="hepatite" id="hepatite" onchange="selection_hepatite()">
								<label class="form-check-label" for="autre">Hépatites</label>
							</div>		
							<div style="display: none;margin-left: 20px" id="hepatiteForm">
								<div class="form-check" id="precisionhepatiteForm">
									<input class="form-check-input" type="checkbox" name="precisionhepatite" value="precisionhepatite" id="precisionhepatite" onchange="selection_date_hepatite()"/>
									<label for="precisionhepatite">VHB</label>
								</div>
								<div class="form-check" id="datediagvhbForm" style="display: none;" ">
									<label class="form-label" for="datediagvhb">Date du diagnostic</label>
									<input class="form-control" type="date" name="datediagvhb" id="datediagvhb" value="precisionhepatite" />
								</div>
								<div class="form-check" id="precisionhepatitebForm" style="display: none">
									<input class="form-check-input" type="checkbox" name="precisionhepatiteb" value="precisionhepatiteb" id="precisionhepatiteb" onchange="selection_date_hepatiteb()" />
									<label class="form-check-label" for="precisionhepatiteb">VHC</label>
								</div>
								<div class="form-check" id="datediagvhcForm" style="display: none">
									<label class="form-label" for="datediagvhc">Date du diagnostic</label> 
									<input class="form-control" type="date" name="datediagvhc" id="datediagvhc"/>
								</div>
							</div>
						
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="neo">
								<label class="form-check-label" for="autre">Néoplasique</label>
							</div>
	
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="den">
								<label class="form-check-label" for="autre">Dénutrition</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="patho" value="autre" id="autre" onchange="selection_pathologies()">
								<label class="form-check-label" for="autre">Autre</label>
							</div>
							<div class="form-check" id="autrepathoForm" style="display: none">
								<label class="form-check-label" for="autrepatho">précisez </label>
								<input type="text" name="autrepatho" id="autrepatho" /> 
							</div>
						</div>

					</div>

					<div class="col-md">
					
						<div class="titre">Douleurs</div>
		
						<div>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="douleur" value="oui" id="oui" onchange="eva()" />
								<label class="form-check-label" for="oui">Oui</label>
							</div>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="douleur" value="non" id="non" onchange="eva()" />
								<label class="form-check-label" for="non">Non</label>
							</div>
						</div>
						<div id="echelleevaForm" style="display: none">
							<div class="row">
								<div class="col-md">
									<label for="echelleeva" class="col-form-label">EVA (de 0 à 10)</label>
								</div>
								<div class="col-md">
									<input class="form-control" type="number" name="echelleeva" value="0" id="echelleeva" min="0" max="10"/>
								</div>
							</div>
						</div>
		
		
						<div class="titre">Besoin de rééducation</div>
						<div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="reeduc" value="kine">
								<label class="form-check-label">Kinésithérapie</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="reeduc" value="ergo"/>
								<label class="form-check-label">Ergotherapie</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="reeduc" value="regime"/>
								<label class="form-check-label">Régime adapté</label>
							</div>
						</div>

						<div class="titre">Addictions présentes au cours des 12 derniers mois</div>

						<div>

							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="addictions" value="Alccol">
								<label class="form-check-label">Alcool</label>
							</div>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" name="addictions" value="Tabac">
								<label class="form-check-label">Tabac</label>
							</div>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="checkbox" name="addictions" value="drogues" id="drogues" onchange="drogue()">
								<label class="form-check-label">Consommation de drogues</label>
							</div>
						</div>
						<div>
							<div class="form-check">
								<label class="form-check-label" for="cannabis" id="cannabislabel" style="display: none">Cannabis</label>
								<input class="form-check-input" type="checkbox" name="cannabis" value="cannabis" id="cannabis" style="display: none">
							</div>
						</div>
						<div>
							<div class="form-check" id="crackForm" style="display: none;margin-left: 20px">
								<input class="form-check-input" type="checkbox" name="crack" value="crack" id="crack">
								<label class="form-check-label" for="crack">Crack/Cocaïne</label>
							</div>
							<div class="form-check form-check-inline" id="opiacesForm" style="display: none;margin-left: 20px">
								<input class="form-check-input" type="checkbox" name="opiaces" value="opiaces" id="opiaces"/>
								<label class="form-check-label" for="opiaces" >Opiacés</label>
							</div>
							<div class="form-check" id="autresdroguesForm" style="display: none;margin-left: 20px" >
								<input class="form-check-input" type="checkbox" name="autresdrogues" value="autresdrogues" id="autresdrogues" onchange="autredrogue()">
								<label for="autresdrogues" >Autres</label>
							</div>
						</div>
						
						<div class="form" id="autredrogueprecisionForm" style="display: none;margin-left: 20px" >
							<label class="form-label" for="autredrogueprecision">précisez </label>
							<input class="form-control" type="text" name="autredrogueprecision" id="autredrogueprecision" value="autre drogue"/>
						</div>
						
						
						
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12" style="margin-bottom: 20px; text-align: center;">
					<button type="submit" class="btn btn-info" onclick="cleanCim10()">Valider</button>
				</div>
			</div>
		</div>
	
</form>


	<script type="text/javascript">
	
	document.getElementById('formMedical').onsubmit = function() {
	    return isValidForm();
	};
	
	function isValidForm(){
		var taille = $('#taille').val();
		var poids = $('#poids').val();
		
		if (taille < 100 || taille > 210){
			alert('Erreur : taille ' + taille + ' incorrecte.');
			return false;
		}		
		if (poids < 30 || poids > 150){
			alert('Erreur : poids ' + poids + ' incorrect.');
			return false;
		}
		
		return true;
	}
	
	function selection_motif_entree() {

		var motifentreelam = $("#autre:checked");

		if (motifentreelam.val() === 'autre') {
			$('#autreentreeForm').show();

		} else {
			$('#autreentreeForm').hide();
			$('#autreentree').val('');
		}
	}

	function eva() {
		var eva = $("#oui:checked");

		if (eva.val() === 'oui') {
			$('#echelleevaForm').show();

		} else {
			$('#echelleevaForm').hide();
			$('#echelleeva').val('');
		}

	}

	function selection_hepatite() {

		var patho = $("#hepatite:checked");

		if (patho.val() === 'hepatite') {
			$('#hepatiteForm').show();
			$('#precisionhepatiteForm').show();
			$('#precisionhepatitebForm').show();
		} else {
			$('#hepatiteForm').hide();				
			$('#precisionhepatiteForm').hide();
			$('#precisionhepatitebForm').hide();
			$('#datediagvhbForm').hide();
			$('#datediagvhcForm').hide();

			$('#precisionhepatite').val('');
			$('#precisionhepatiteb').val('');
			$('#datediagvhb').val('');
			$('#datediagvhc').val('');
		}
	}

	function selection_date_hepatite() {

		var hep = $("#precisionhepatite");

		if (hep.is(':checked')){
			$('#datediagvhbForm').show();

		} else {
			$('#datediagvhbForm').hide();
			$('#datediagvhb').val('');
		}
	}

	function selection_date_hepatiteb() {

		var hepb = $("#precisionhepatiteb:checked");

		if (hepb.is(':checked')){
			$('#datediagvhcForm').show();

		} else {
			$('#datediagvhcForm').hide();
			$('#datediagvhc').val('');
		}
	}

	function selection_pathologies() {

		var patho = $("#autre:checked");

		if (patho.val() === 'autre') {
			$('#autrepathoForm').show();  

		} else {
			$('#autrepathoForm').hide();
			$('#autrepatho').val('');
		}
	}

	function drogue() {

		var drogue = $("#drogues:checked");

		if (drogue.val() === 'drogues') {
			$('#cannabisForm').show();
			$('#crackForm').show();
			$('#opiacesForm').show();
			$('#autresdroguesForm').show();
		} else {

			$('#cannabisForm').hide();
			$('#cannabis').val('');
			$('#crackForm').hide();
			$('#crack').val('');
			$('#autresForm').hide();
			$('#autres').val('');
		}
	}

	function autredrogue() {
		var drogueprecision = $("#autresdrogues:checked");

		if (drogueprecision.val() === 'autresdrogues') {
			$('#autredrogueprecisionForm').show();

		} else {
			$('#autredrogueprecisionForm').hide();
			$('#autredrogueprecision').val('');
		}
	}

		
	$(document).ready(function() {
		$('#cim10').autocomplete({
			serviceUrl: 'getCim10.php',
			paramName: "search",
			delimiter: ",",
			transformResult: function(response) {
				return {
					//must convert json to javascript object before process
					suggestions: $.map($.parseJSON(response), function(item) {
						return { value: item.tagName, data: item.id };
					})
				};
			}
		 });
	  });

	function cleanCim10() {
		var code = $("#cim10").val();
		first = code.indexOf("(");
		last = code.length;
		$('#cim10').val(code.substring(first + 1, last - 1));
	}
</script>
</body>
</html>
